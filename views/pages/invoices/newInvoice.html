<div class="row">
  <div class="col-md-12 col-sm-12 col-xs-12">
    <form novalidate ng-submit="newInvoice()">
      <div class="x_panel">
        <div class="x_title">
          <div class="row">
            <div class="col-md-4" style="padding-top:15px;">
              <h2>إضافة فاتورة جديدة</h2>
            </div>
            <div class="col-md-3">
              <div class="form-group pull-left" style="margin-bottom:0;">
                <label class="control-label">هل الزبون مشترك جديد ؟</label>
                <select class="form-control input-sm" ng-model="previousSubscription" required>
                  <option value="1">نعم</option>
                  <option value="2">لا</option>
                </select>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label class="control-label">نوع الفاتورة</label>
                <select class="form-control input-sm" ng-model="newInvoiceForm.typein" required>
                  <option value="" disabled selected>الرجاء الاختيار</option>
                  <option value="1">فاتورة</option>
                  <option value="2">مبدئية</option>
                </select>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">اسم الموزع</label>
                <select class="form-control input-sm" ng-model="newInvoiceForm.reseller" required>
                  <option value="" disabled selected>الرجاء الاختيار</option>
                  <option value="1">الشركة الام</option>
                  <option ng-repeat="reseller in objects.resellersObj" value="{{reseller._id}}">{{reseller.companyName}}</option>
                </select>
              </div>
            </div>
          </div>
          <div class="clearfix"></div>
        </div>
        <div class="x_content">
          <div ng-if="previousSubscription == 1">
            <div class="row">
              <div class="col-md-4" ng-class="{'col-md-3': newInvoiceForm.type==2}">
                <div class="form-group">
                  <label class="control-label">نوع العميل</label>
                  <select class="form-control input-sm" ng-model="newInvoiceForm.type" ng-required-err-type="type" required>
                    <option value="" disabled selected>الرجاء الاختيار</option>
                    <option value="1">شخصي</option>
                    <option value="2">شركة</option>
                  </select>
                </div>
              </div>
              
              <div class="col-md-4" ng-class="{'col-md-3': newInvoiceForm.type==2}">
                <div class="form-group">
                  <label class="control-label">اسم العميل</label>
                  <input class="form-control input-sm" type="text" ng-model="newInvoiceForm.name" ng-required-err-type="name" placeholder="اسم العميل" required>
                </div>
              </div>
              <div class="col-md-3" ng-if="newInvoiceForm.type == 2">
                <div class="form-group">
                  <label class="control-label">اسم المندوب</label>
                  <input class="form-control input-sm" type="text" ng-model="newInvoiceForm.repName" ng-required-err-type="repName" placeholder="اسم المندوب" required>
                </div>
              </div>
              <div class="col-md-4" ng-class="{'col-md-3': newInvoiceForm.type==2}">
                <div class="form-group">
                  <label class="control-label">المدينة</label>
                  <select class="form-control input-sm" ng-model="newInvoiceForm.city" ng-options="city.id as city.nameAr for city in objects.citiesObj" ng-required-err-type="city" required>
                    <option value="" disabled selected>الرجاء الاختيار</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="row">

              <div class="col-md-3">
                <div class="form-group">
                  <label class="control-label">العنوان</label>
                  <input class="form-control input-sm" type="text" ng-model="newInvoiceForm.address" ng-required-err-type="address" placeholder="العنوان" required>
                </div>
              </div>
              <div class="col-md-3">
                <div class="form-group">
                  <label class="control-label">البريد الالكتروني</label>
                  <input class="form-control input-sm" type="email" ng-model="newInvoiceForm.email" ng-required-err-type="emailType" placeholder="البريد الالكتروني" required>
                </div>
              </div>
              <div class="col-md-3">
                <div class="form-group">
                  <label class="control-label">رقم الهاتف</label>
                  <input class="form-control input-sm" type="text" ng-model="newInvoiceForm.phone" ng-required-err-type="phone" placeholder="رقم الهاتف" required>
                </div>
              </div>
              <div class="col-md-3">
                <div class="form-group">
                  <label class="control-label">ملاحظات</label>
                  <textarea class="form-control input-sm" rows="6" ng-model="newInvoiceForm.notes" ng-required-err-type="notes" placeholder="ملاحظات"></textarea>
                </div>
              </div>
            </div>
          </div>

          <div ng-if="previousSubscription == 2">
            <div class="row">
              <div class="col-md-12">
                <ol class="nya-bs-select form-control input-sm" ng-model="student" data-live-search="true" >
                  <li nya-bs-option="customer in customers">
                    <a >
                     <p ng-click="go(customer._id,customer.name)">
                      {{customer.name}}
                    </p>
                  
                      <span class="glyphicon glyphicon-ok check-mark"></span>
                    </a>
                  </li>
                </ol>
              </div>
            </div>
          </div>
          <hr>
          <div class="row">
            <!-- <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">نوع الفاتورة</label>
                <select class="form-control input-sm" ng-model="newInvoiceForm.typein" ng-required-err-type="type" required>
                  <option value="" disabled selected>الرجاء الاختيار</option>
                  <option value="Invoice">فاتورة</option>
                  <option value="Initial">مبدئية</option>
                </select>
              </div>
            </div> -->
            <div class="col-md-2">
              <div class="form-group">
                <label class="control-label">نوع المنتج</label>
                <select class="form-control input-sm" ng-model="productType" ng-change="getProductInfo(productType)">
                  <option value="" disabled selected>الرجاء الاختيار</option>
                  <option value="خدمة">خدمة - service</option>
                  <option value="معدة">معدة - item</option>
                  <option value="حزمة">حزمة - package</option>
                  <option value="معدات">معدات اخرى - other item</option>
                </select>
                <span style="color:red;" ng-show="productTypeRequired">هذا الحقل مطلوب</span>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">اختيار المنتج</label>
                <select class="form-control input-sm" ng-model="productName" ng-change="test()" ng-options="product.name for product in productsObj track by product._id">
                  <option value="" disabled selected>الرجاء الاختيار</option>
                </select>
                <span style="color:red;" ng-show="productNameRequired">هذا الحقل مطلوب</span>
              </div>
            </div>
            <div class="col-md-1" style="padding-top:24px;">
              <button type="button" class="btn btn-primary btn-sm" ng-click="selectProduct()"><i class="fa fa-plus"></i>&nbsp;إضافة</button>
            </div>
            <div class="col-md-6">
              <div ng-show="selectedProducts.length == 0" style="padding-top:10px;">
                <div class="alert alert-info">
                  <p class="text-center">
                    عفوا لا توجد منتجات مختارة الرجاء الاختيار
                  </p>
                </div>
              </div>
              <h4 class="text-center animated fadeIn" ng-show="selectedProducts.length">
                المنتجات المختارة
              </h4>
              <table ng-show="selectedProducts.length" class="table table-striped table-condensed jambo_table animated fadeIn">
                <thead>
                  <tr>
                    <th>نوع المنتج</th>
                    <th>اسم المنتج</th>
                    <th>السعر</th>
                    <th>إلغاء</th>
                  </tr>
                </thead>
                <tbody>
                  <tr ng-repeat="selectedProduct in selectedProducts">
                    <td>
                      {{selectedProduct.type}}
                    </td> 
                    <td>{{selectedProduct.name}}</td> 
                     <td>{{selectedProduct.price}}</td> 
                    <td>
                      <button type="button" class="btn btn-danger btn-xs" ng-click="removeSelect($index)"><i class="fa fa-trash"></i></button>
                    </td> 
                  </tr> 
                </tbody> 
              </table>
            </div>
          </div>
          <hr>
          <div class="row">
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">المخــازن</label>
                <select class="form-control input-sm" ng-model="stock"  ng-change="getStockId(stock._id)" ng-options="stock as stock.name for stock in objects.stockObj">
                  <option value="" selected>الرجاء الاختيار</option>
                </select>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">ماك ادرس</label>
                <select class="form-control input-sm" ng-model="inStockdata" ng-change="showId(stock._id)"  ng-options="inStock as inStock.macAddress for inStock in getData">
                  <option value="" disabled selected>الرجاء الاختيار</option>
                </select>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">تاريخ البداية</label>
                <input class="form-control input-sm" type="text" ng-model="newInvoiceForm.startDate" placeholder="تاريخ البداية" required bs-datepicker>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">تاريخ النهاية</label>
                <input class="form-control input-sm" type="text" ng-model="newInvoiceForm.endDate" placeholder="تاريخ النهاية" required bs-datepicker>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">التخفيض</label>
                <input  class="form-control input-sm" type="text" ng-model="newInvoiceForm.discount"  placeholder="التخفيض">
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">الاجمالي</label>
                <input class="form-control input-sm" type="text" ng-model="newInvoiceForm.total" placeholder="الاجمالي" required>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">ملاحظات</label>
                <textarea class="form-control input-sm" rows="6" ng-model="newInvoiceForm.invoceNotes" ng-required-err-type="notes" placeholder="ملاحظات"></textarea>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">الدفعة</label>
                <input  class="form-control input-sm" type="text" ng-model="newInvoiceForm.paid"  placeholder="الدفعة">
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">ملاحظات</label>
                <textarea class="form-control input-sm" rows="6" ng-model="newInvoiceForm.paidNotes" ng-required-err-type="notes" placeholder="ملاحظات"></textarea>
              </div>
            </div>

          </div>
          <div class="row">
            <div class="col-md-4" ng-show="itemInfo.length == 0">
              <div class="alert alert-info">
                <p class="text-center">
                  عفوا لاتوجد هذه المعدة
                </p>
              </div>
            </div>
            <div class="col-md-2" ng-show="itemInfo">
              <div class="form-group">
                <label class="control-label">اسم المستخدم</label>
                <input class="form-control input-sm" type="text" ng-model="itemInfo.username" disabled>
              </div>
            </div>
            <div class="col-md-2" ng-show="itemInfo">
              <div class="form-group">
                <label class="control-label">كلمة المرور</label>
                <input class="form-control input-sm" type="text" ng-model="itemInfo.password" disabled>
              </div>
            </div>
          </div>
          <hr>
          <div class="row">
            <div class="col-md-2 col-md-offset-4">
              <button type="submit" class="btn btn-primary btn-sm btn-block"><i class="fa fa-print"></i>&nbsp;طباعة الفاتورة</button>
            </div>
            <div class="col-md-2">
              <a class="btn btn-success btn-sm btn-block" ui-sref="invoiceCustomer"><i class="fa fa-ban"></i>&nbsp;إلغاء</a>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>